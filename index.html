<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Karantez-Krono - Journal de bord num√©rique</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .modal { display: none; }
        .modal.active { display: flex; }
        .theme-yellow { --bg: #000; --card-bg: #1f2937; --text: #fbbf24; --accent: #fde047; --border: #fbbf24; }
        .theme-blue { --bg: #fff; --card-bg: #eff6ff; --text: #1e3a8a; --accent: #1d4ed8; --border: #93c5fd; }
        .theme-green { --bg: #fff; --card-bg: #f0fdf4; --text: #14532d; --accent: #16a34a; --border: #86efac; }
    </style>
</head>
<body class="theme-yellow" style="background-color: var(--bg); color: var(--text); min-height: 100vh; font-family: system-ui;">
    
    <!-- Header -->
    <header style="background-color: var(--card-bg); padding: 1rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);">
        <div style="max-width: 1024px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center;">
            <h1 style="font-size: 2rem; font-weight: bold; color: var(--accent);">Karantez-Krono</h1>
            <button id="settingsBtn" style="padding: 0.5rem; border-radius: 50%; background-color: #374151; color: var(--text); border: none; cursor: pointer;">
                ‚öôÔ∏è
            </button>
        </div>
    </header>

    <!-- Settings Panel -->
    <div id="settingsPanel" style="background-color: var(--card-bg); padding: 1rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1); display: none;">
        <div style="max-width: 1024px; margin: 0 auto;">
            <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: 0.75rem; color: var(--accent);">Th√®mes</h3>
            <div style="display: flex; gap: 0.5rem;">
                <button onclick="changeTheme('yellow')" style="padding: 0.5rem 1rem; border-radius: 0.5rem; background-color: #fbbf24; color: #000; border: none; cursor: pointer;">Jaune & Noir</button>
                <button onclick="changeTheme('blue')" style="padding: 0.5rem 1rem; border-radius: 0.5rem; background-color: #3b82f6; color: #fff; border: none; cursor: pointer;">Bleu & Blanc</button>
                <button onclick="changeTheme('green')" style="padding: 0.5rem 1rem; border-radius: 0.5rem; background-color: #10b981; color: #fff; border: none; cursor: pointer;">Vert & Blanc</button>
            </div>
        </div>
    </div>

    <!-- Navigation temporelle -->
    <div style="background-color: var(--card-bg); padding: 1rem;">
        <div style="max-width: 1024px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center;">
            <button id="prevDay" style="padding: 0.5rem; border-radius: 50%; background-color: #374151; color: var(--text); border: none; cursor: pointer;">
                ‚Üê
            </button>
            <div style="text-align: center;">
                <h2 id="currentDate" style="font-size: 1.25rem; font-weight: 600; color: var(--accent);">
                    Aujourd'hui
                </h2>
                <p id="postCount" style="font-size: 0.875rem; opacity: 0.7;">
                    0 post
                </p>
            </div>
            <button id="nextDay" style="padding: 0.5rem; border-radius: 50%; background-color: #374151; color: var(--text); border: none; cursor: pointer;">
                ‚Üí
            </button>
        </div>
    </div>
<!-- Ajout affichage de tous les post  -->

<div style="max-width: 1024px; margin: 1rem auto; text-align: center;">
    <a href="tous-les-posts.html" style="padding: 0.75rem 1.5rem; background-color: var(--accent); color: #000; border-radius: 9999px; text-decoration: none; font-weight: bold;">
        üìñ Voir tous les posts
    </a>
</div>

    <!-- Timeline des posts -->
    <main style="max-width: 1024px; margin: 0 auto; padding: 1rem;">
        <div id="postsContainer">
            <div id="emptyState" style="text-align: center; padding: 3rem 0;">
                <div style="font-size: 4rem; margin-bottom: 1rem; opacity: 0.5;">üìÖ</div>
                <p style="font-size: 1.125rem; opacity: 0.7;">Aucun post pour cette date</p>
                <p style="font-size: 0.875rem; opacity: 0.5; margin-top: 0.5rem;">Cr√©ez votre premier souvenir !</p>
            </div>
        </div>
    </main>

    <!-- Bouton flottant nouveau post -->
    <button id="newPostBtn" style="position: fixed; bottom: 1.5rem; right: 1.5rem; width: 3.5rem; height: 3.5rem; border-radius: 50%; background-color: var(--accent); color: #000; border: none; font-size: 1.5rem; cursor: pointer; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);">
        +
    </button>

    <!-- Modal nouveau post -->
    <div id="newPostModal" class="modal" style="position: fixed; inset: 0; background-color: rgba(0,0,0,0.5); align-items: center; justify-content: center; padding: 1rem; z-index: 50;">
        <div style="background-color: var(--bg); border-radius: 0.5rem; padding: 1.5rem; width: 100%; max-width: 42rem; max-height: 90vh; overflow-y: auto;">
            <h2 style="font-size: 1.5rem; font-weight: bold; margin-bottom: 1.5rem; color: var(--accent);">Nouveau post</h2>
            
            <form id="newPostForm" style="display: flex; flex-direction: column; gap: 1rem;">
                <div>
                    <label style="display: block; font-size: 0.875rem; font-weight: 500; margin-bottom: 0.5rem;">Titre *</label>
                    <input type="text" id="postTitle" required style="width: 100%; padding: 0.75rem; border-radius: 0.5rem; border: 1px solid var(--border); background-color: var(--card-bg); color: var(--text);" placeholder="Titre de votre d√©couverte...">
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div>
                        <label style="display: block; font-size: 0.875rem; font-weight: 500; margin-bottom: 0.5rem;">Auteur/Artiste</label>
                        <input type="text" id="postAuthor" style="width: 100%; padding: 0.75rem; border-radius: 0.5rem; border: 1px solid var(--border); background-color: var(--card-bg); color: var(--text);" placeholder="Nom de l'auteur...">
                    </div>
                    <div>
                        <label style="display: block; font-size: 0.875rem; font-weight: 500; margin-bottom: 0.5rem;">Cat√©gorie</label>
                        <select id="postCategory" style="width: 100%; padding: 0.75rem; border-radius: 0.5rem; border: 1px solid var(--border); background-color: var(--card-bg); color: var(--text);">
                            <option value="books">üìö Livres</option>
                            <option value="films">üé¨ Films</option>
                            <option value="music">üéµ Musique</option>
                            <option value="concerts">üé§ Concerts</option>
                            <option value="exhibitions">üñºÔ∏è Expositions</option>
                            <option value="recipes">üç≥ Recettes</option>
                            <option value="series">üì∫ S√©ries TV</option>
                            <option value="architecture">üèõÔ∏è Architecture</option>
                        </select>
                    </div>
                </div>

                <div>
                    <label style="display: block; font-size: 0.875rem; font-weight: 500; margin-bottom: 0.5rem;">Date</label>
                    <input type="date" id="postDate" style="width: 100%; padding: 0.75rem; border-radius: 0.5rem; border: 1px solid var(--border); background-color: var(--card-bg); color: var(--text);">
                </div>

                <div>
                    <label style="display: block; font-size: 0.875rem; font-weight: 500; margin-bottom: 0.5rem;">Description courte</label>
                    <input type="text" id="postShortDesc" style="width: 100%; padding: 0.75rem; border-radius: 0.5rem; border: 1px solid var(--border); background-color: var(--card-bg); color: var(--text);" placeholder="R√©sum√© en une phrase...">
                </div>

                <div>
                    <label style="display: block; font-size: 0.875rem; font-weight: 500; margin-bottom: 0.5rem;">Description d√©taill√©e</label>
                    <textarea id="postLongDesc" rows="4" style="width: 100%; padding: 0.75rem; border-radius: 0.5rem; border: 1px solid var(--border); background-color: var(--card-bg); color: var(--text);" placeholder="Vos impressions, critique, notes..."></textarea>
                </div>

                <div>
                    <label style="display: block; font-size: 0.875rem; font-weight: 500; margin-bottom: 0.5rem;">Lien externe</label>
                    <input type="url" id="postLink" style="width: 100%; padding: 0.75rem; border-radius: 0.5rem; border: 1px solid var(--border); background-color: var(--card-bg); color: var(--text);" placeholder="https://...">
                </div>

                <div>
                    <label style="display: block; font-size: 0.875rem; font-weight: 500; margin-bottom: 0.5rem;">Image (URL)</label>
                    <input type="url" id="postImageUrl" style="width: 100%; padding: 0.75rem; border-radius: 0.5rem; border: 1px solid var(--border); background-color: var(--card-bg); color: var(--text);" placeholder="URL de l'image...">
                </div>

                <div style="display: flex; align-items: center; gap: 0.75rem;">
                    <input type="checkbox" id="postIsPublic" checked style="width: 1rem; height: 1rem;">
                    <label for="postIsPublic" style="font-size: 0.875rem; font-weight: 500;">Post public (visible par les autres)</label>
                </div>

                <div style="display: flex; gap: 0.75rem; margin-top: 1.5rem;">
                    <button type="button" id="cancelBtn" style="padding: 0.75rem 1.5rem; border-radius: 0.5rem; background-color: #6b7280; color: #fff; border: none; cursor: pointer;">Annuler</button>
                    <button type="submit" style="padding: 0.75rem 1.5rem; border-radius: 0.5rem; background-color: var(--accent); color: #000; border: none; cursor: pointer;">Cr√©er le post</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Variables globales
        let posts = JSON.parse(localStorage.getItem('karantez-posts') || '[]');
        let currentDate = new Date();
        let currentTheme = localStorage.getItem('karantez-theme') || 'yellow';

        // Cat√©gories avec emojis
        const categories = {
            books: 'üìö',
            films: 'üé¨',
            music: 'üéµ',
            concerts: 'üé§',
            exhibitions: 'üñºÔ∏è',
            recipes: 'üç≥',
            series: 'üì∫',
            architecture: 'üèõÔ∏è'
        };

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            // D√©finir la date du jour
            document.getElementById('postDate').valueAsDate = new Date();
            
            // Appliquer le th√®me sauvegard√©
            changeTheme(currentTheme);
            
            // Afficher les posts du jour
            displayPosts();
            updateDateDisplay();

            // Event listeners
            document.getElementById('settingsBtn').addEventListener('click', toggleSettings);
            document.getElementById('prevDay').addEventListener('click', () => navigateDate(-1));
            document.getElementById('nextDay').addEventListener('click', () => navigateDate(1));
            document.getElementById('newPostBtn').addEventListener('click', openNewPostModal);
            document.getElementById('cancelBtn').addEventListener('click', closeNewPostModal);
            document.getElementById('newPostForm').addEventListener('submit', createPost);
        });

        // Gestion des th√®mes
        function changeTheme(theme) {
            currentTheme = theme;
            document.body.className = `theme-${theme}`;
            localStorage.setItem('karantez-theme', theme);
        }

        // Toggle settings
        function toggleSettings() {
            const panel = document.getElementById('settingsPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }

        // Navigation dans les dates
        function navigateDate(direction) {
            currentDate.setDate(currentDate.getDate() + direction);
            displayPosts();
            updateDateDisplay();
        }

        // Mise √† jour de l'affichage de la date
        function updateDateDisplay() {
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('currentDate').textContent = currentDate.toLocaleDateString('fr-FR', options);
            
            const postsForDate = getPostsForDate();
            const count = postsForDate.length;
            document.getElementById('postCount').textContent = `${count} ${count > 1 ? 'posts' : 'post'}`;
        }

        // Obtenir les posts pour la date courante
        function getPostsForDate() {
            const dateStr = currentDate.toISOString().split('T')[0];
            return posts.filter(post => post.date === dateStr);
        }

        // Afficher les posts
        function displayPosts() {
            const container = document.getElementById('postsContainer');
            const postsForDate = getPostsForDate();
            
            if (postsForDate.length === 0) {
                container.innerHTML = `
                    <div id="emptyState" style="text-align: center; padding: 3rem 0;">
                        <div style="font-size: 4rem; margin-bottom: 1rem; opacity: 0.5;">üìÖ</div>
                        <p style="font-size: 1.125rem; opacity: 0.7;">Aucun post pour cette date</p>
                        <p style="font-size: 0.875rem; opacity: 0.5; margin-top: 0.5rem;">Cr√©ez votre premier souvenir !</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = postsForDate.map(post => `
                <article style="background-color: var(--card-bg); border-radius: 0.5rem; padding: 1.5rem; margin-bottom: 1.5rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); border: 1px solid var(--border);">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem;">
                        <div style="display: flex; align-items: center; gap: 0.75rem;">
                            <span style="font-size: 1.5rem;">${categories[post.category] || 'üìù'}</span>
                            <div>
                                <h3 style="font-size: 1.25rem; font-weight: 600; color: var(--text);">${post.title}</h3>
                                ${post.author ? `<p style="font-size: 0.875rem; opacity: 0.7;">par ${post.author}</p>` : ''}
                            </div>
                        </div>
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <button onclick="likePost(${post.id})" style="display: flex; align-items: center; gap: 0.25rem; padding: 0.25rem 0.75rem; border-radius: 9999px; background-color: #374151; color: var(--text); border: none; cursor: pointer;">
                                ‚ù§Ô∏è ${post.hearts}
                            </button>
                            <span style="padding: 0.25rem 0.5rem; border-radius: 9999px; font-size: 0.75rem; ${post.isPublic ? 'background-color: #dcfce7; color: #166534;' : 'background-color: #f3f4f6; color: #374151;'}">
                                ${post.isPublic ? 'Public' : 'Priv√©'}
                            </span>
                        </div>
                    </div>
                    
                    ${post.imageUrl ? `<div style="margin-bottom: 1rem;"><img src="${post.imageUrl}" alt="${post.title}" style="width: 100%; max-height: 16rem; object-fit: cover; border-radius: 0.5rem;"></div>` : ''}
                    
                    ${post.shortDescription ? `<p style="margin-bottom: 0.75rem; color: var(--accent); font-weight: 500;">${post.shortDescription}</p>` : ''}
                    
                    ${post.longDescription ? `<p style="margin-bottom: 0.75rem; line-height: 1.6; opacity: 0.9;">${post.longDescription}</p>` : ''}
                    
                    ${post.link ? `<a href="${post.link}" target="_blank" rel="noopener noreferrer" style="display: inline-block; padding: 0.25rem 0.75rem; border-radius: 9999px; font-size: 0.875rem; background-color: var(--accent); color: #000; text-decoration: none;">Voir plus ‚Üí</a>` : ''}
                </article>
            `).join('');
        }

        // Liker un post
        function likePost(postId) {
            posts = posts.map(post => 
                post.id === postId ? { ...post, hearts: post.hearts + 1 } : post
            );
            localStorage.setItem('karantez-posts', JSON.stringify(posts));
            displayPosts();
        }

        // Ouvrir le modal nouveau post
        function openNewPostModal() {
            document.getElementById('newPostModal').classList.add('active');
        }

        // Fermer le modal nouveau post
        function closeNewPostModal() {
            document.getElementById('newPostModal').classList.remove('active');
            document.getElementById('newPostForm').reset();
            document.getElementById('postDate').valueAsDate = new Date();
        }

        // Cr√©er un nouveau post
        function createPost(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const post = {
                id: Date.now(),
                title: document.getElementById('postTitle').value,
                author: document.getElementById('postAuthor').value,
                category: document.getElementById('postCategory').value,
                shortDescription: document.getElementById('postShortDesc').value,
                longDescription: document.getElementById('postLongDesc').value,
                link: document.getElementById('postLink').value,
                imageUrl: document.getElementById('postImageUrl').value,
                isPublic: document.getElementById('postIsPublic').checked,
                hearts: 0,
                date: document.getElementById('postDate').value,
                createdAt: new Date().toISOString()
            };

            posts.push(post);
            localStorage.setItem('karantez-posts', JSON.stringify(posts));
            
            closeNewPostModal();
            displayPosts();
            updateDateDisplay();
        }
    </script>
</body>
</html>